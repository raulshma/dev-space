<project_specification>
  <project_name>AppSelect Installer Platform</project_name>

  <overview>
    A platform that lets users choose from a list of supported applications via a terminal-style web UI, and then download a custom .NET console-based installer that will install the selected applications on Windows. Supported applications will be stored in a Turso database. The web UI will mimic a terminal aesthetic with interactive selection and search. The system will be extendable, maintainable, secure, and follow modern best practices.
  </overview>

  <technology_stack>
    <frontend>
      <framework>Next.js (React + App Router)</framework>
      <styling>Tailwind CSS (for UI)</styling>
      <terminal_ui>Custom terminal-inspired components</terminal_ui>
      <state_management>React Hooks + Zustand or Jotai</state_management>
      <data_fetching>Next.js App Router (server & client components)</data_fetching>
      <security_content>CSRF/XSS protections, sanitization</security_content>
    </frontend>
    <backend>
      <runtime>.NET 8 Console for installer</runtime>
      <language>C#</language>
      <distribution>Self-contained Windows EXE</distribution>
      <web_api>Next.js Server Actions / API routes</web_api>
      <database>Turso (libSQL)</database>
      <orm>Drizzle ORM (Node.js/TypeScript)</orm>
      <validation>Zod for input and download payloads</validation>
      <auth>JWT + secure tokens for download generation</auth>
      <security>HTTPS enforced, CSP headers, rate limiting</security>
    </backend>
    <communication>
      <api>RESTful or Next.js Server Actions</api>
      <auth>JWT auth for protected operations</auth>
    </communication>
  </technology_stack>

  <prerequisites>
    <environment_setup>
      - Turso database URL and auth token in .env
      - Next.js dependencies installed via pnpm
      - Create .NET console project (targeting Windows)
      - Ensure Windows signing certs setup (optional)
    </environment_setup>
  </prerequisites>

  <core_features>
    <application_catalog>
      - List supported applications
      - Store name, installer URL, icon, version, tags
      - Support search/filter by name/tag
      - Admin area to add/edit supported apps
    </application_catalog>

    <user_selection>
      - Terminal-inspired select/deselect UI (checkbox style)
      - Search and filter within terminal
      - Keyboard navigation support
      - Preview of selected applications
    </user_selection>

    <download_generation>
      - Generate custom installer payload
      - Create secure token for installer download
      - Bundle selection metadata (JSON) embedded in installer
      - Provide download link
    </download_generation>

    <installer_app>
      - Written in .NET Console
      - Reads selection metadata
      - Downloads & installs chosen apps
      - Simple progress UI in console
      - Logging and rollback on errors
      - Validate admin privileges, prompt UAC if needed
    </installer_app>

    <security_features>
      - Token expiry for downloads
      - Input validation server side
      - HTTPS only
      - Sanitize user input for search/filter
      - Rate limiting for API
    </security_features>
  </core_features>

  <database_schema>
    <tables>
      <supported_applications>
        - id (TEXT PRIMARY KEY)
        - name (TEXT NOT NULL)
        - installer_url (TEXT NOT NULL)
        - icon_url (TEXT)
        - description (TEXT)
        - tags (TEXT JSON)
        - created_at (DATETIME)
        - updated_at (DATETIME)
      </supported_applications>

      <download_requests>
        - id (TEXT PRIMARY KEY)
        - token (TEXT UNIQUE)
        - app_ids (TEXT JSON)
        - created_at (DATETIME)
        - expires_at (DATETIME)
      </download_requests>
    </tables>
  </database_schema>

  <api_endpoints_summary>
    <applications>
      - GET /api/apps/list
      - GET /api/apps/:id
      - POST /api/apps/search?q=query
    </applications>

    <downloads>
      - POST /api/download/create
      - GET /api/download/:token
    </downloads>

    <admin>
      - POST /api/admin/apps
      - PUT /api/admin/apps/:id
      - DELETE /api/admin/apps/:id
    </admin>
  </api_endpoints_summary>

  <ui_layout>
    <main_structure>
      - Full-screen terminal theme
      - Prompt input area
      - Scrollable app list
      - Highlighted selections
      - Keyboard shortcut hints
    </main_structure>

    <header>
      - Terminal styled header (App Selector)
      - Search prompt
    </header>

    <app_list_view>
      - Terminal lines for each app
      - Checkbox or highlight for selected
      - Search bar at top
      - Pagination if needed
    </app_list_view>

    <footer>
      - Instructions (e.g., ↑↓ to move, Space to select)
      - “Download Installer” button
    </footer>
  </ui_layout>

  <design_system>
    <color_palette>
      - Background: Black (#000000)
      - Text: Green (#00FF00), White (#FFFFFF)
      - Accent: Cyan (#00FFFF)
      - Error: Red (#FF3333)
      - Success: Green (#33FF33)
    </color_palette>

    <typography>
      - Monospace UI (e.g., Consolas, Courier New)
      - Terminal prompt style
      - Clear high-contrast text
    </typography>

    <animations>
      - Subtle cursor blink
      - Loading spinner for fetch
    </animations>
  </design_system>

  <key_interactions>
    <app_selection_flow>
      1. Load terminal UI with searchable app list
      2. User navigates with keyboard/search
      3. User selects apps (toggle)
      4. Selected apps count updates
      5. User submits selection
      6. Server generates installer token
      7. User downloads .exe installer
    </app_selection_flow>

    <installer_execution_flow>
      1. User runs downloaded .NET installer
      2. Installer reads token & selected apps
      3. Installer downloads application installers
      4. Installer runs installers sequentially
      5. Progress shown in console
      6. On finish show summary & any errors
    </installer_execution_flow>

    <admin_manage_apps_flow>
      1. Admin visits secured admin UI
      2. Adds/edits/deletes applications
      3. Changes persist in Turso
      4. App list updates for users
    </admin_manage_apps_flow>
  </key_interactions>

  <implementation_steps>
    <step number="1">
      <title>Project Setup & Database Modeling</title>
      <tasks>
        - Initialize Next.js (latest)
        - Setup Tailwind CSS
        - Setup Turso DB
        - Create Drizzle ORM schema + migrations
        - Create basic apps list API
      </tasks>
    </step>

    <step number="2">
      <title>Terminal-Style UI & Search</title>
      <tasks>
        - Build terminal UI
        - Keyboard navigation
        - Search/filter support
        - Connect to apps list API
      </tasks>
    </step>

    <step number="3">
      <title>Download Token & Installer Generation</title>
      <tasks>
        - Create GET/POST download endpoints
        - Token generation + TTL
        - Build server logic for .NET installer payload
      </tasks>
    </step>

    <step number="4">
      <title>.NET Console Installer</title>
      <tasks>
        - Scaffold .NET console project
        - Parse token + download selection metadata
        - Download & install apps
        - Logging + progress UI
      </tasks>
    </step>

    <step number="5">
      <title>Admin UI for Supported Apps</title>
      <tasks>
        - Build Admin pages
        - Protect with auth
        - Add/edit/delete supported apps
      </tasks>
    </step>

    <step number="6">
      <title>Security Hardening & Testing</title>
      <tasks>
        - Validate API inputs
        - Rate limiting
        - Token expiry checks
        - End-to-end tests
        - Penetration testing
      </tasks>
    </step>

    <step number="7">
      <title>Polish & Deployment</title>
      <tasks>
        - UI enhancements
        - CI/CD pipeline
        - Build release installer workflow
        - Monitoring/analytics
      </tasks>
    </step>
  </implementation_steps>

  <success_criteria>
    <functionality>
      - Users can preview and select apps
      - Installer package generated with correct selections
      - .NET installer runs and installs chosen apps
      - Admin can manage supported apps
    </functionality>

    <user_experience>
      - Terminal UI feels responsive
      - Keyboard first interface
      - Clear feedback on actions
      - Secure download flow
    </user_experience>

    <technical_quality>
      - Clean modular codebases
      - Secure API
      - Tokenized downloads
      - Tests covering core logic
    </technical_quality>

    <security_and_maintainability>
      - Sanitized input
      - Strong authentication
      - Logging and error handling
      - CI/CD with tests
    </security_and_maintainability>
  </success_criteria>
</project_specification>
